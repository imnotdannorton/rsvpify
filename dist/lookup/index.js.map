{"version":3,"sources":["../../src/lookup/index.js"],"names":["lookup","mongoUrl","process","env","MONGODB_URI","connect","err","res","console","log","guestSchema","Schema","name","String","attending","Boolean","guests","Number","request","invite_id","Guest","model","remove","demo","save","find","req","id","params","results","guest","findOne","result","push","json","update","userData","body","item"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEA,IAAIA,SAAS,EAAb;AACA,IAAIC,WAAWC,QAAQC,GAAR,CAAYC,WAA3B;;AAEA,mBAASC,OAAT,CAAiBJ,QAAjB,EAA2B,UAACK,GAAD,EAAMC,GAAN,EAAY;AACtC,KAAGD,GAAH,EAAO;AACNE,UAAQC,GAAR,CAAY,yBAAuBR,QAAvB,GAAgC,IAA5C,EAAkDK,GAAlD;AACA,EAFD,MAEK;AACJE,UAAQC,GAAR,CAAY,eAAaR,QAAzB;AACA;AACD,CAND;;AAQA,IAAIS,cAAc,IAAI,mBAASC,MAAb,CAAoB;AACrCC,OAAKC,MADgC;AAErCC,YAAUC,OAF2B;AAGrCC,SAAOC,MAH8B;AAIrCC,UAAQL,MAJ6B;AAKrCM,YAAUN;AAL2B,CAApB,CAAlB;;AAQA,IAAIO,QAAQ,mBAASC,KAAT,CAAe,QAAf,EAAyBX,WAAzB,CAAZ;;AAEAU,MAAME,MAAN,CAAa,EAAb,EAAiB,UAAShB,GAAT,EAAc;AAC7B,KAAIA,GAAJ,EAAS;AACPE,UAAQC,GAAR,CAAa,0BAAb,EAAyCH,GAAzC;AACD;AACF,CAJD;;AAMA,IAAIiB,OAAO,IAAIH,KAAJ,CAAU;AACpBR,OAAK,iBADe;AAEpBE,YAAU,IAFU;AAGpBE,SAAO,CAHa;AAIpBE,UAAQ,6BAJY;AAKpBC,YAAU;AALU,CAAV,CAAX;;AAQAI,KAAKC,IAAL,CAAW,UAAClB,GAAD,EAAS;AACnB,KAAGA,GAAH,EAAO;AACNE,UAAQC,GAAR,CAAY,cAAZ,EAA4BH,GAA5B;AACA;AACD,CAJD;;AAMAN,OAAOyB,IAAP,GAAc,UAASC,GAAT,EAAcnB,GAAd,EAAkB;AAC9B,KAAIoB,KAAKD,IAAIE,MAAJ,CAAWD,EAApB;AACA,KAAIE,UAAU,EAAd;AACA;AACA;AACA;AACA;AACA;AACA,KAAIC,QAAQV,MAAMW,OAAN,CAAc,EAAC,aAAYJ,EAAb,EAAd,EAAgC,UAACrB,GAAD,EAAM0B,MAAN,EAAiB;AAC5DxB,UAAQC,GAAR,CAAY,OAAZ,EAAqBH,GAArB,EAA0B,UAA1B,EAAsC0B,MAAtC;AACA,MAAGA,MAAH,EAAU;AACTH,WAAQI,IAAR,CAAaD,MAAb;AACAzB,OAAI2B,IAAJ,CAAS,EAAC,WAAUL,OAAX,EAAT;AACA,GAHD,MAGK;AACJA,WAAQI,IAAR,CAAa,EAAC,QAAO,YAAR,EAAb;AACA1B,OAAI2B,IAAJ,CAAS,EAAC,WAAUL,OAAX,EAAT;AACA;AACD,EATW,CAAZ;AAUD,CAlBD;AAmBA7B,OAAOmC,MAAP,GAAgB,UAAST,GAAT,EAAanB,GAAb,EAAiB;AAChC,KAAI6B,WAAWV,IAAIW,IAAnB;AACA,KAAIZ,OAAO,EAAC,aAAYW,SAASjB,SAAtB,EAAX;AACAC,OAAMe,MAAN,CAAaV,IAAb,EAAmBW,QAAnB,EAA6B,UAAC9B,GAAD,EAAMgC,IAAN,EAAe;AAC3C9B,UAAQC,GAAR,CAAY,WAAZ,EAAyB6B,IAAzB,EAA+B,SAA/B,EAA0ChC,GAA1C;AACA,MAAGgC,IAAH,EAAQ;AACP/B,OAAI2B,IAAJ,CAAS,EAAC,WAAU,SAAX,EAAT;AACA,GAFD,MAEK;AACJ3B,OAAI2B,IAAJ,CAAS,EAAC,WAAU,OAAX,EAAT;AACA;AACD,EAPD;AAQA,CAXD;;kBAaelC,M","file":"index.js","sourcesContent":["import facets from '../models/facets';\nimport mongoose from 'mongoose';\n\nlet lookup = {}\nlet mongoUrl = process.env.MONGODB_URI;\n\nmongoose.connect(mongoUrl, (err, res)=>{\n\tif(err){\n\t\tconsole.log(\"error connecting to \"+mongoUrl+\": \", err);\n\t}else{\n\t\tconsole.log(\"success!: \"+mongoUrl);\n\t}\n});\n\nlet guestSchema = new mongoose.Schema({\n\tname:String,\n\tattending:Boolean,\n\tguests:Number,\n\trequest:String,\n\tinvite_id:String\n});\n\nlet Guest = mongoose.model('guests', guestSchema);\n\nGuest.remove({}, function(err) {\n  if (err) {\n    console.log ('error deleting old data.', err);\n  }\n});\n\nlet demo = new Guest({\n\tname:\"Ella Fitzgerald\",\n\tattending:true,\n\tguests:2,\n\trequest:\"I wanna Dance With Somebody\",\n\tinvite_id:\"01432\"\n});\n\ndemo.save( (err) => {\n\tif(err){\n\t\tconsole.log('error saving', err);\n\t}\n});\n\nlookup.find = function(req, res){\n  let id = req.params.id;\n  let results = []\n  // facets.forEach(function(item){\n  //   if(item.id == id){\n  //     results.push(item);\n  //   }\n  // })\n  let guest = Guest.findOne({\"invite_id\":id}, (err, result) => {\n  \tconsole.log('err: ', err, 'result: ', result);\n  \tif(result){\n  \t\tresults.push(result);\n  \t\tres.json({'results':results});\n  \t}else{\n  \t\tresults.push({'name':'none found'});\n  \t\tres.json({'results':results});\n  \t}\n  });\n}\nlookup.update = function(req,res){\n\tlet userData = req.body;\n\tlet find = {'invite_id':userData.invite_id};\n\tGuest.update(find, userData, (err, item) => {\n\t\tconsole.log('updated: ', item, 'error? ', err);\n\t\tif(item){\n\t\t\tres.json({'message':'success'});\n\t\t}else{\n\t\t\tres.json({'message':'error'});\n\t\t}\n\t}); \t\n}\n\nexport default lookup"]}