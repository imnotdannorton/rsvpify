{"version":3,"sources":["../../../src/public/js/form-actions.js"],"names":["resultObj","handleKey","e","which","keyCode","findEntry","lookupResponse","JSON","parse","responseText","results","resString","forEach","item","name","_id","attending","placeholderTxt","request","length","reqTxt","document","getElementById","innerHTML","className","id","value","req","XMLHttpRequest","addEventListener","open","send","saveEntries","num","attendingVal","options","selectedIndex","reqVal","console","log","updateEntry","body","classList","remove","setRequestHeader","stringify"],"mappings":"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","file":"form-actions.js","sourcesContent":["var resultObj;\n// enable submit listener for enter on find focus\nfunction handleKey(e){\n  e.which = e.which || e.keyCode;\n  if(e.which == 13) {\n      findEntry();\n  }\n}\nfunction lookupResponse(){\n  resultObj = JSON.parse(this.responseText).results;\n  var resString = \"<p><h2>Guests:</h2>\"\n  resultObj.forEach(function(item){\n    // build rsvp inputs\n    resString += '<strong>'+item.name+'</strong><br/>';\n    resString += '<span>Attending? </span><select id=\"'+item._id+'_attending\">';\n    // check attending val and build dropdown\n    if(item.attending){\n      resString += '<option value=\"true\" selected>Yes!</option><option value=\"false\">No :(</option>';\n    }else{\n      resString += '<option value=\"false\" selected>No :(</option><option value=\"true\">Yes!</option>';\n    }\n    resString += '</select></br>';\n    // initialize request fields\n    var placeholderTxt = item.request.length > 0 ? item.request : 'REQUEST A SONG';\n    var reqTxt = item.request.length > 0 ? item.request : '';\n    resString += 'I want to hear: <input type=\"text\" placeholder=\"'+placeholderTxt+'\" value=\"'+reqTxt+'\" id=\"'+item._id+'_songRequest\"></p>';\n  });\n  document.getElementById(\"response\").innerHTML = resString;\n  document.getElementById(\"updateForm\").className = 'active';\n}\nfunction findEntry(){\n  // look up by rsvp ID\n  var id = document.getElementById(\"rsvpCode\").value \n  var req = new XMLHttpRequest();\n  req.addEventListener('load', lookupResponse)\n  req.open('GET', '/find/'+id);\n  req.send();\n}\nfunction saveEntries(){\n  resultObj.forEach( function(item){\n    // attach rsvp and request val to guest object\n    var num = document.getElementById(item._id+\"_attending\");\n    var attendingVal = num.options[num.selectedIndex].value;\n    var reqVal = document.getElementById(item._id+\"_songRequest\").value\n    console.log('request input value is: ', reqVal, 'object value is: ', item.request);\n    // if(reqVal != item.request)\n    item.attending = attendingVal;\n    item.request = reqVal != item.request ? reqVal : item.request;\n    updateEntry(item);\n  });\n}\nfunction updateEntry(item){\n  var body = item;\n  var req = new XMLHttpRequest();\n  req.addEventListener('load', function(){\n    console.log(this.responseText);\n    document.getElementById(\"response\").innerHTML = \"Thanks for updating!\";\n    document.getElementById(\"updateForm\").classList.remove(\"active\");\n  });\n  req.open('POST', '/update', true);\n  req.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n  req.send(JSON.stringify(body));\n} "]}